<!-- Web App: Grilyato, Reichniy, Armstrong -->
<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mahsulot Tanlash</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 1rem;
      background-color: #f3f4f6;
    }
    h1, h2 {
      text-align: center;
    }
    .tabs {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .tab {
      padding: 0.5rem 1rem;
      background-color: #e5e7eb;
      border-radius: 5px;
      cursor: pointer;
    }
    .tab.active {
      background-color: #3b82f6;
      color: white;
    }
    .products {
      display: none;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
    }
    .products.active {
      display: flex;
    }
    .card {
      background: white;
      border-radius: 10px;
      padding: 1rem;
      width: 250px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .card img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 5px;
    }
    .price {
      font-weight: bold;
      margin: 0.5rem 0;
    }
    input[type="number"] {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.5rem;
    }
    .total {
      margin-top: 0.5rem;
      font-weight: bold;
    }
    button {
      margin-top: 0.5rem;
      width: 100%;
      padding: 0.5rem;
      background: #10b981;
      border: none;
      color: white;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Mahsulotlar</h1>
  <div class="tabs">
    <div class="tab active" data-tab="grilyato">Grilyato</div>
    <div class="tab" data-tab="reichniy">Reichniy</div>
    <div class="tab" data-tab="armstrong">Armstrong</div>
  </div>

  <div id="grilyato" class="products active"></div>
  <div id="reichniy" class="products"></div>
  <div id="armstrong" class="products"></div>

  <script>
    const products = {
      grilyato: [
        { name: "Oq", price: 50000, img: "https://picsum.photos/id/1015/250/150" },
        { name: "Qora", price: 55000, img: "https://picsum.photos/id/1025/250/150" }
      ],
      reichniy: [
        { name: "Oq", price: 45000, img: "https://picsum.photos/id/1035/250/150" },
        { name: "Kulrang", price: 48000, img: "https://picsum.photos/id/1045/250/150" }
      ],
      armstrong: [
        { name: "Standard", price: 40000, img: "https://picsum.photos/id/1055/250/150" },
        { name: "Premium", price: 60000, img: "https://picsum.photos/id/1065/250/150" }
      ]
    };

    const renderProducts = (key) => {
      const container = document.getElementById(key);
      container.innerHTML = "";
      products[key].forEach((p, i) => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <img src="${p.img}" alt="${p.name}" />
          <h3>${p.name}</h3>
          <div class="price">Narx: ${p.price.toLocaleString()} so'm/m²</div>
          <input type="number" placeholder="m² kiriting" min="1" id="input-${key}-${i}" />
          <div class="total" id="total-${key}-${i}">Jami: 0 so'm</div>
          <button onclick="sendOrder('${key}', '${p.name}', ${p.price}, ${i})">Buyurtma qilish</button>
        `;
        container.appendChild(div);
      });
    };

    const tabs = document.querySelectorAll(".tab");
    tabs.forEach(tab => {
      tab.onclick = () => {
        tabs.forEach(t => t.classList.remove("active"));
        document.querySelectorAll(".products").forEach(p => p.classList.remove("active"));
        tab.classList.add("active");
        document.getElementById(tab.dataset.tab).classList.add("active");
      }
    });

    Object.keys(products).forEach(k => renderProducts(k));

    function sendOrder(type, name, price, index) {
      const input = document.getElementById(`input-${type}-${index}`);
      const metr = parseFloat(input.value || 0);
      const total = metr * price;
      const totalStr = total.toLocaleString();
      document.getElementById(`total-${type}-${index}`).textContent = `Jami: ${totalStr} so'm`;
      if (window.Telegram.WebApp) {
        Telegram.WebApp.sendData(`${type} - ${name} | ${metr} m² × ${price} = ${totalStr} so'm`);
      } else {
        alert("Buyurtma: " + `${type} - ${name} | ${metr} m² × ${price} = ${totalStr} so'm`);
      }
    }
  </script>
</body>
</html>
